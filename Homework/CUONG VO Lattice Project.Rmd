---
title: "CUONG VO - Lattice Homework"
output:
  pdf_document: default
  html_document: default
date: "2023-12-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Import Lattice

```{r echo=TRUE}
library(lattice)
```

## Excesise 1
Please change  graphics charts generated by code listed below to lattice charts.
Program 1
``` {r echo=TRUE}
### R base graphic
par(mai = c(1, 1, 1, 1), omi = c(0, 0, 0, 0))
xx <- c(9.20, 6.00, 6.00, 11.25, 11.00, 7.25, 9.7, 13.25, 14.00, 8.00)
hist(xx, breaks = c(6, 8, 10, 12, 14), right = F)
```

```{r echo=TRUE}
### Lattice
my.themes <- trellis.par.get()
my.themes$layout.heights$top.padding = 0
my.themes$layout.heights$bottom.padding = 0
my.themes$layout.widths$left.padding = 0
my.themes$layout.widths$right.padding = 0
trellis.par.set(my.themes)
xx <- c(9.20, 6.00, 6.00, 11.25, 11.00, 7.25, 9.7, 13.25, 14.00, 8.00)
histogram(~xx, type ="count", main = "Histogram of xx")
```

Program 2
``` {r echo=TRUE}
### R base graphic
par(mai = c(1, 1, 1, 1), omi = c(0, 0, 0, 0))
set.seed(591)
xx1 <- rnorm(20, mean = 3, sd = 3.6)
xx2 <- rpois(40, lambda = 3.5)
xx3 <- rchisq(31, df = 5, ncp = 0)
box1 <- boxplot(xx1, xx2, xx3, names = c("Group-1", "Group-2","Group-3"), cex = 0.7)
```

```{r echo=TRUE}
### Lattice
my.themes <- trellis.par.get()
my.themes$layout.heights$top.padding = 0
my.themes$layout.heights$bottom.padding = 0
my.themes$layout.widths$left.padding = 0
my.themes$layout.widths$right.padding = 0
my.themes$plot.symbol$cex = 0.7
trellis.par.set(my.themes)
set.seed(591)
xx1 <- rnorm(20, mean = 3, sd = 3.6)
xx2 <- rpois(40, lambda = 3.5)
xx3 <- rchisq(31, df = 5, ncp = 0)
df <- data.frame(values = c(xx1, xx2, xx3), 
                groups = rep(c("Group-1", "Group-2", "Group-3"), 
                             c(length(xx1), length(xx2), length(xx3))))
bwplot(values ~ groups, data = df)
```

## Excesise 2

```{r include=FALSE}
library(BCA)
library(corrplot)
library(tidyr)
library(gridExtra)
data(Eggs)
```

Code compared between R based graphic and Lattice - Boxplot

:::::: {.columns}
::: {.column width="50%"}
```{r echo=TRUE, eval=FALSE}
### R based graphic
boxplot(Eggs[,"Cases"], main = 'Cases Number')
```
:::

::: {.column width="50%"}
```{r echo=TRUE, eval=FALSE}
### Lattice
df <- data.frame(Items = "Cases", Amount = Eggs[,"Cases"])
bwplot(Amount~Items, data=df, main = "Cases Number")
```
:::
::::::

Code compared between R based graphic and Lattice - Boxplot

:::::: {.columns}
::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### R based graphic
boxplot(Eggs[,c( "Egg.Pr", "Beef.Pr", "Pork.Pr", "Chicken.Pr", "Cereal.Pr")])
```
:::

::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### Lattice
df <- Eggs[,c( "Egg.Pr", "Beef.Pr", "Pork.Pr", "Chicken.Pr", "Cereal.Pr")]
df <- df %>% pivot_longer(
  cols = c(Egg.Pr, Beef.Pr, Pork.Pr, Chicken.Pr, Cereal.Pr), 
  names_to = "Items", 
  values_to = "Price" )
bwplot(Price~Items, data=df)
```
:::
::::::

Code compared between R based graphic and Lattice - Histogram

:::::: {.columns}
::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### R based graphic
# Simmilar for remain items
hist(Eggs$Cases, main = "Cases", xlab = "")
```
:::

::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### Lattice
# Similar for remain items
histogram(~Eggs$Cases, main = "Cases", type = "count")
```
:::
::::::

Code compared between R based graphic and Lattice - Corrplot

:::::: {.columns}
::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### R based graphic
a<-data.frame(Eggs$Beef.Pr,
              Eggs$Cases,
              Eggs$Cereal.Pr,
              Eggs$Chicken.Pr,
              Eggs$Egg.Pr,
              Eggs$Pork.Pr,
              Eggs$Week)
b<-cor(a)
corrplot(b)
```
:::

::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### Lattice
a<-data.frame(Eggs$Beef.Pr,
              Eggs$Cases,
              Eggs$Cereal.Pr,
              Eggs$Chicken.Pr,
              Eggs$Egg.Pr,
              Eggs$Pork.Pr,
              Eggs$Week)
b<-cor(a)
levelplot(b, scale=list(x=list(rot=45)))
```
:::
::::::

Code compared between R based graphic and Lattice - line chart

:::::: {.columns}
::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### R based graphic
plot(Eggs$Week, Eggs$Egg.Pr, type = 'l', xlab = "", ylab = "", axes = FALSE, main = "Eggs")
```
:::

::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### Lattice
xyplot(Egg.Pr~Week, data = Eggs, type = "o", pch = 16, lty = 4, main = "Eggs", 
       xlab = "", ylab = "", scales = list(draw=F))
```
:::
::::::

Code compared between R based graphic and Lattice - timeseries

:::::: {.columns}
::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### R based graphic
Egg_Price <- ts(Eggs$Egg.Pr, start = c(1992,1), frequency = 52)
Egg_pr_comp <- decompose(Egg_Price)
plot(Egg_pr_comp)
```
:::

::: {.column width="50%"}
``` {r echo=TRUE, eval=FALSE}
### Lattice
Egg_Price <- ts(Eggs$Egg.Pr, start = c(1992,1), frequency = 52)
Egg_pr_comp <- decompose(Egg_Price)
df <- data.frame(weeks = Eggs$Week,
                 Egg = as.vector(Egg_pr_comp$x))
obs <- xyplot(Egg~weeks, data=df, type = "o", pch = 16, lty = 4, main = "Eggs Observation")
df <- data.frame(weeks = Eggs$Week,
                 Egg = as.vector(Egg_pr_comp$trend))
trend <- xyplot(Egg~weeks, data=df, type = "o", pch = 16, lty = 4, main = "Eggs Trend")

df <- data.frame(weeks = Eggs$Week,
                 Egg = as.vector(Egg_pr_comp$seasonal))
seasonal <- xyplot(Egg~weeks, data=df, type = "o", pch = 16, lty = 4, main = "Eggs Seasonal")

df <- data.frame(weeks = Eggs$Week,
                 Egg = as.vector(Egg_pr_comp$random))
rand <- xyplot(Egg~weeks, data=df, type = "o", pch = 16, lty = 4, main = "Eggs Random")

grid.arrange(obs, trend, seasonal, rand, nrow = 2, ncol = 2)
```
:::
::::::